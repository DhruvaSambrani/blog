<!doctype html><html xmlns=http://www.w3.org/1999/xhtml lang xml:lang><meta charset=utf-8><meta name=generator content="pandoc"><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes"><meta name=author content="Dhruva Sambrani"><meta name=keywords content="mysetup,mycreation,todoman,suckless"><title>My Todo Manager | Dhruva's Blog</title><link rel=stylesheet href=/blog/assets/css/pandoc-styles.css><link rel=stylesheet href=/blog/assets/css/styles.css><script data-external=1 src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js></script><div class=markdown-body><h1 id=my-todo-manager>My Todo Manager</h1><h1 id=calcurse>Calcurse</h1><p>In my previous post about <a href=./2021-08-20_010631>my Calender Setup</a>, I mentioned about how I was using Calcurse as my calender. Now calcurse also has a Todo section which works great, except that I have to open calcurse to use it. I just want to quickly see what I need to do, press enter to say I am done with it and it should be gone. Adding an entry should be just as easy<h1 id=enter-dmenu>Enter dmenu</h1><p><code>dmenu</code> is a suckless menu selector which has fuzzy search (patch), default text (patch) and autocomplete. This is everything I need. So I made a script to use dmenu as my So I simply read the calcurse todo file and display a menu with each entry in the todo as a dmenu entry.<p>When user inputs, I check if it matches any previous entry. If it does, then I remove the entry from the todo file.<p>When the user input does not match any entry, it is assumed to be a new entry, and added to the file.<h1 id=rounding-off-edges>Rounding off edges</h1><p>This solution has 2 problems,<ol type=1><li>Calcurse uses a numbered ranking to signify the urgency of the entry. But adding a new entry at the default urgency is hard to type: <code>[0] Something I have to do</code>. So if the new entry input doesnâ€™t start with <code>\[.\]</code>, the script just adds <code>[0]</code><li>There is no way to edit an entry. So I changed the script to put back the last deleted entry into the prompt. So an <code>edit</code> is actually a delete followed by a re-entry. If you really wanted to delete an entry, then just hit <code>ctrl-u</code> to clear the line.</ol><h1 id=tying-it-all-up-together>Tying it all up together</h1><p>I added a keybind to dwm to run my script, and everything works so beautifully. Now I can go and remove the todo entry to write this post.<h1 id=final-script>Final script</h1><p>Here is the final script-<div class=sourceCode id=cb1><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb1-1><a href=#cb1-1 aria-hidden=true tabindex=-1></a><span class=co>#!/bin/zsh</span></span>
<span id=cb1-2><a href=#cb1-2 aria-hidden=true tabindex=-1></a><span class=co>#</span></span>
<span id=cb1-3><a href=#cb1-3 aria-hidden=true tabindex=-1></a><span class=co># Write/remove a task to do later.</span></span>
<span id=cb1-4><a href=#cb1-4 aria-hidden=true tabindex=-1></a><span class=co>#</span></span>
<span id=cb1-5><a href=#cb1-5 aria-hidden=true tabindex=-1></a><span class=co># Select an existing entry to remove it from the file, or type a new entry to</span></span>
<span id=cb1-6><a href=#cb1-6 aria-hidden=true tabindex=-1></a><span class=co># add it.</span></span>
<span id=cb1-7><a href=#cb1-7 aria-hidden=true tabindex=-1></a><span class=co>#</span></span>
<span id=cb1-8><a href=#cb1-8 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-9><a href=#cb1-9 aria-hidden=true tabindex=-1></a><span class=va>file</span><span class=op>=</span><span class=st>&quot;</span><span class=va>$HOME</span><span class=st>/.calcurse/todo&quot;</span></span>
<span id=cb1-10><a href=#cb1-10 aria-hidden=true tabindex=-1></a><span class=fu>touch</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span></span>
<span id=cb1-11><a href=#cb1-11 aria-hidden=true tabindex=-1></a><span class=va>height</span><span class=op>=</span><span class=va>$(</span><span class=fu>wc</span> <span class=at>-l</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span> <span class=kw>|</span> <span class=fu>awk</span> <span class=st>&#39;{print $1}&#39;</span><span class=va>)</span></span>
<span id=cb1-12><a href=#cb1-12 aria-hidden=true tabindex=-1></a><span class=va>prompt</span><span class=op>=</span><span class=st>&quot;Add/delete a task: &quot;</span></span>
<span id=cb1-13><a href=#cb1-13 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-14><a href=#cb1-14 aria-hidden=true tabindex=-1></a><span class=va>cmd</span><span class=op>=</span><span class=va>$(</span><span class=fu>sort</span> <span class=at>-r</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span> <span class=kw>|</span> <span class=ex>dmenu</span> <span class=at>-l</span> <span class=st>&quot;</span><span class=va>$height</span><span class=st>&quot;</span> <span class=at>-p</span> <span class=st>&quot;</span><span class=va>$prompt</span><span class=st>&quot;</span> <span class=at>-i</span> <span class=va>)</span></span>
<span id=cb1-15><a href=#cb1-15 aria-hidden=true tabindex=-1></a><span class=cf>while</span> <span class=bu>[</span> <span class=ot>-n</span> <span class=st>&quot;</span><span class=va>$cmd</span><span class=st>&quot;</span> <span class=bu>]</span><span class=kw>;</span> <span class=cf>do</span></span>
<span id=cb1-16><a href=#cb1-16 aria-hidden=true tabindex=-1></a>  <span class=cf>if</span> <span class=fu>grep</span> <span class=at>-qF</span> <span class=st>&quot;</span><span class=va>$cmd</span><span class=st>&quot;</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span><span class=kw>;</span> <span class=cf>then</span></span>
<span id=cb1-17><a href=#cb1-17 aria-hidden=true tabindex=-1></a>        <span class=fu>grep</span> <span class=at>-vF</span> <span class=st>&quot;</span><span class=va>$cmd</span><span class=st>&quot;</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span> <span class=op>&gt;</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>.new&quot;</span> <span class=co># This selects all the lines that DONT match</span></span>
<span id=cb1-18><a href=#cb1-18 aria-hidden=true tabindex=-1></a>        <span class=fu>mv</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>.new&quot;</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span></span>
<span id=cb1-19><a href=#cb1-19 aria-hidden=true tabindex=-1></a>    <span class=kw>((</span> <span class=va>height</span> <span class=op>=</span> <span class=va>height</span> <span class=op>-</span> <span class=dv>1</span> <span class=kw>))</span></span>
<span id=cb1-20><a href=#cb1-20 aria-hidden=true tabindex=-1></a>    <span class=cf>else</span></span>
<span id=cb1-21><a href=#cb1-21 aria-hidden=true tabindex=-1></a>    <span class=cf>if</span> <span class=kw>[[</span> <span class=st>&quot;</span><span class=va>$(</span><span class=bu>echo</span> <span class=va>$cmd</span> <span class=kw>|</span> <span class=fu>tr</span> <span class=at>-d</span> <span class=dt>\\</span>n<span class=va>)</span><span class=st>&quot;</span> <span class=ot>=~</span> <span class=st>&quot;^\[[[:digit:]]\]&quot;</span> <span class=kw>]];</span> <span class=cf>then</span></span>
<span id=cb1-22><a href=#cb1-22 aria-hidden=true tabindex=-1></a>      <span class=bu>echo</span> <span class=st>&quot;</span><span class=va>$cmd</span><span class=st>&quot;</span> <span class=op>&gt;&gt;</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span></span>
<span id=cb1-23><a href=#cb1-23 aria-hidden=true tabindex=-1></a>    <span class=cf>else</span></span>
<span id=cb1-24><a href=#cb1-24 aria-hidden=true tabindex=-1></a>      <span class=bu>echo</span> <span class=st>&quot;[0] </span><span class=va>$cmd</span><span class=st>&quot;</span> <span class=op>&gt;&gt;</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span></span>
<span id=cb1-25><a href=#cb1-25 aria-hidden=true tabindex=-1></a>    <span class=cf>fi</span></span>
<span id=cb1-26><a href=#cb1-26 aria-hidden=true tabindex=-1></a>    <span class=va>cmd</span><span class=op>=</span><span class=st>&quot;&quot;</span></span>
<span id=cb1-27><a href=#cb1-27 aria-hidden=true tabindex=-1></a>    <span class=kw>((</span> <span class=va>height</span> <span class=op>=</span> <span class=va>height</span> <span class=op>+</span> <span class=dv>1</span> <span class=kw>))</span></span>
<span id=cb1-28><a href=#cb1-28 aria-hidden=true tabindex=-1></a>    <span class=cf>fi</span></span>
<span id=cb1-29><a href=#cb1-29 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-30><a href=#cb1-30 aria-hidden=true tabindex=-1></a>  <span class=va>cmd</span><span class=op>=</span><span class=va>$(</span><span class=fu>sort</span> <span class=at>-r</span> <span class=st>&quot;</span><span class=va>$file</span><span class=st>&quot;</span> <span class=kw>|</span> <span class=ex>dmenu</span> <span class=at>-l</span> <span class=st>&quot;</span><span class=va>$height</span><span class=st>&quot;</span> <span class=at>-p</span> <span class=st>&quot;</span><span class=va>$prompt</span><span class=st>&quot;</span> <span class=at>-it</span> <span class=st>&quot;</span><span class=va>$cmd</span><span class=st>&quot;</span> <span class=st>&quot;</span><span class=va>$@</span><span class=st>&quot;</span> <span class=va>)</span></span>
<span id=cb1-31><a href=#cb1-31 aria-hidden=true tabindex=-1></a><span class=cf>done</span></span>
<span id=cb1-32><a href=#cb1-32 aria-hidden=true tabindex=-1></a></span>
<span id=cb1-33><a href=#cb1-33 aria-hidden=true tabindex=-1></a><span class=bu>exit</span> 0</span></code></pre></div></div><div class="markdown-body tags"><a href=/blog/tags.html#mysetup>#mysetup<a>, <a href=/blog/tags.html#mycreation>#mycreation<a>, <a href=/blog/tags.html#todoman>#todoman<a>, <a href=/blog/tags.html#suckless>#suckless<a></div><footer><a class=footer-button id=home href=/blog/tags.html>Tags</a>
<img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-nc/4.0/88x31.png>
<a id=fivetwelvea href=https://512kb.club><img id=fivetwelve alt="a proud member of the green team of 512KB club"></a>
<a class=footer-button id=contents href=/blog/contents.html>Contents</a></footer>